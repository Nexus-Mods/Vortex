{"version":3,"file":"index.js","mappings":";;;;;;;;;;AAAa;AACb;AACA;AACA;AACA;AACA,eAAe,oCAAoC;AACnD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA,0CAA0C,4BAA4B;AACtE,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,sBAAsB,mBAAO,CAAC,qDAAoB;AAClD,4CAA4C,mBAAO,CAAC,uEAA6B;AACjF,6CAA6C,mBAAO,CAAC,mEAA2B;AAChF,mCAAmC,mBAAO,CAAC,0BAAU;AACrD,0BAA0B,mBAAO,CAAC,kBAAM;AACxC,qBAAqB,mBAAO,CAAC,8BAAY;AACzC,wCAAwC,mBAAO,CAAC,0CAAkB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAe;;;;;;;;;;;ACvLF;AACb;AACA;AACA;AACA;AACA,eAAe,oCAAoC;AACnD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA,0CAA0C,4BAA4B;AACtE,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,eAAe,GAAG,mBAAmB,GAAG,qBAAqB,GAAG,uBAAuB,GAAG,2BAA2B;AACrH,0BAA0B,mBAAO,CAAC,kBAAM;AACxC,qBAAqB,mBAAO,CAAC,8BAAY;AACzC,2BAA2B;AAC3B;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,CAAC;AACD;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA,eAAe;;;;;;;;;;;ACjIF;AACb;AACA;AACA;AACA;AACA,eAAe,oCAAoC;AACnD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA,0CAA0C,4BAA4B;AACtE,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,4BAA4B;AAC5B,mCAAmC,mBAAO,CAAC,0BAAU;AACrD,0BAA0B,mBAAO,CAAC,kBAAM;AACxC,qBAAqB,mBAAO,CAAC,8BAAY;AACzC,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA,kBAAe;;;;;;;;;;;ACzDF;AACb;AACA;AACA;AACA;AACA,eAAe,oCAAoC;AACnD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA,0CAA0C,4BAA4B;AACtE,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,mCAAmC,mBAAO,CAAC,0BAAU;AACrD,0BAA0B,mBAAO,CAAC,kBAAM;AACxC,qBAAqB,mBAAO,CAAC,8BAAY;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,kBAAe;;;;;;;;;;;ACrDf;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UEtBA;UACA;UACA;UACA","sources":["webpack://gamebryo-test-settings/./src/index.ts","webpack://gamebryo-test-settings/./src/util/gameSupport.ts","webpack://gamebryo-test-settings/./src/util/missingOblivionFonts.ts","webpack://gamebryo-test-settings/./src/util/missingSkyrimFonts.ts","webpack://gamebryo-test-settings/external commonjs2 \"bluebird\"","webpack://gamebryo-test-settings/external commonjs2 \"path\"","webpack://gamebryo-test-settings/external commonjs2 \"vortex-api\"","webpack://gamebryo-test-settings/external commonjs2 \"vortex-parse-ini\"","webpack://gamebryo-test-settings/webpack/bootstrap","webpack://gamebryo-test-settings/webpack/before-startup","webpack://gamebryo-test-settings/webpack/startup","webpack://gamebryo-test-settings/webpack/after-startup"],"sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst gameSupport_1 = require(\"./util/gameSupport\");\nconst missingOblivionFonts_1 = __importStar(require(\"./util/missingOblivionFonts\"));\nconst missingSkyrimFonts_1 = __importDefault(require(\"./util/missingSkyrimFonts\"));\nconst bluebird_1 = __importDefault(require(\"bluebird\"));\nconst path = __importStar(require(\"path\"));\nconst vortex_api_1 = require(\"vortex-api\");\nconst vortex_parse_ini_1 = __importStar(require(\"vortex-parse-ini\"));\nconst parser = new vortex_parse_ini_1.default(new vortex_parse_ini_1.WinapiFormat());\nfunction fixOblivionFonts(iniFile, missingFonts, gameId) {\n    return new bluebird_1.default((fixResolve, fixReject) => {\n        try {\n            Object.keys(iniFile.data.Fonts)\n                .forEach((key) => {\n                if (missingFonts.find((item) => {\n                    return item === iniFile.data.Fonts[key];\n                }) !== undefined) {\n                    const keyL = key.toLowerCase();\n                    if (missingOblivionFonts_1.oblivionDefaultFonts[keyL] !== undefined) {\n                        iniFile.data.Fonts[key] = missingOblivionFonts_1.oblivionDefaultFonts[keyL];\n                    }\n                    else {\n                        delete iniFile.data.Fonts[key];\n                    }\n                }\n            });\n            parser.write((0, gameSupport_1.iniPath)(gameId), iniFile)\n                .then(() => fixResolve())\n                .catch(err => fixReject(err));\n        }\n        catch (err) {\n            fixReject(err);\n        }\n    });\n}\nfunction testOblivionFontsImpl(api) {\n    const store = api.store;\n    const gameId = vortex_api_1.selectors.activeGameId(store.getState());\n    if (gameId !== 'oblivion') {\n        return bluebird_1.default.resolve(undefined);\n    }\n    let iniFile;\n    return parser.read((0, gameSupport_1.iniPath)(gameId))\n        .then((iniFileIn) => {\n        iniFile = iniFileIn;\n        return (0, missingOblivionFonts_1.default)(store, iniFile, gameId);\n    })\n        .then((missingFonts) => {\n        if (missingFonts.length === 0) {\n            return bluebird_1.default.resolve(undefined);\n        }\n        const fontList = missingFonts.join('\\n');\n        return bluebird_1.default.resolve({\n            description: {\n                short: 'Fonts missing.',\n                long: 'Fonts referenced in oblivion.ini don\\'t seem to be installed:\\n' +\n                    fontList,\n            },\n            severity: 'error',\n            automaticFix: () => fixOblivionFonts(iniFile, missingFonts, gameId),\n        });\n    })\n        .catch((err) => bluebird_1.default.resolve({\n        description: {\n            short: 'Failed to read Oblivion.ini.',\n            long: err.toString(),\n        },\n        severity: 'error',\n    }));\n}\nconst defaultFonts = {};\nfunction testSkyrimFontsImpl(context) {\n    const store = context.api.store;\n    const gameId = vortex_api_1.selectors.activeGameId(store.getState());\n    const gameDiscovery = vortex_api_1.util.getSafe(store.getState(), ['settings', 'gameMode', 'discovered', gameId], undefined);\n    if (['skyrim', 'enderal', 'skyrimse', 'skyrimvr'].indexOf(gameId) === -1) {\n        return bluebird_1.default.resolve(undefined);\n    }\n    if ((gameDiscovery === undefined) || (gameDiscovery.path === undefined)) {\n        return bluebird_1.default.resolve(undefined);\n    }\n    const game = vortex_api_1.util.getGame(gameId);\n    const interfacePath = path.join(game.getModPaths(gameDiscovery.path)[''], 'Skyrim - Interface.bsa');\n    const prom = defaultFonts[gameId] !== undefined\n        ? bluebird_1.default.resolve(undefined)\n        : context.api.openArchive(interfacePath)\n            .then((archive) => archive.readDir('interface')\n            .tap(() => {\n            var _a;\n            if (((_a = archive['mHandler']) === null || _a === void 0 ? void 0 : _a.closeArchive) !== undefined) {\n                archive['mHandler'].closeArchive();\n            }\n            archive = null;\n        }))\n            .then((files) => {\n            defaultFonts[gameId] = new Set(files\n                .filter(name => path.extname(name) === '.swf')\n                .map(name => path.join('interface', name)));\n        })\n            .catch((err) => {\n            if (err instanceof vortex_api_1.util.NotSupportedError) {\n                (0, vortex_api_1.log)('info', 'Not checking font list because bsa archive support not available');\n                return bluebird_1.default.reject(err);\n            }\n            return vortex_api_1.fs.statAsync(interfacePath)\n                .then(() => {\n                context.api.showErrorNotification('Failed to read default fonts', err, {\n                    message: interfacePath,\n                    allowReport: false,\n                });\n                return bluebird_1.default.reject(new vortex_api_1.util.ProcessCanceled('default fonts unknown'));\n            })\n                .catch(() => {\n                context.api.showErrorNotification('\"Skyrim - Interface.bsa\" appears to be missing', err, {\n                    id: 'skyrim_interface_bsa_missing',\n                    allowReport: false,\n                });\n                return bluebird_1.default.reject(new vortex_api_1.util.ProcessCanceled('default fonts unknown'));\n            });\n        });\n    return prom\n        .then(() => (0, missingSkyrimFonts_1.default)(store.getState(), defaultFonts[gameId], gameId))\n        .then((missingFonts) => {\n        if (missingFonts.length === 0) {\n            return bluebird_1.default.resolve(undefined);\n        }\n        const fontList = missingFonts.join('\\n');\n        return bluebird_1.default.resolve({\n            description: {\n                short: 'Fonts missing.',\n                long: 'Fonts referenced in fontconfig.txt don\\'t seem to be installed:\\n' +\n                    fontList,\n            },\n            severity: 'error',\n        });\n    })\n        .catch(vortex_api_1.util.NotSupportedError, () => bluebird_1.default.resolve(undefined))\n        .catch(vortex_api_1.util.ProcessCanceled, () => bluebird_1.default.resolve(undefined))\n        .catch((err) => {\n        return bluebird_1.default.resolve({\n            description: {\n                short: 'Failed to read fontconfig.txt.',\n                long: err.toString(),\n            },\n            severity: 'error',\n        });\n    });\n}\nfunction init(context) {\n    (0, gameSupport_1.initGameSupport)(context.api);\n    const testOblivionFonts = () => testOblivionFontsImpl(context.api);\n    const testSkyrimFonts = () => testSkyrimFontsImpl(context);\n    context.registerTest('oblivion-fonts', 'gamemode-activated', testOblivionFonts);\n    context.registerTest('skyrim-fonts', 'gamemode-activated', testSkyrimFonts);\n    return true;\n}\nexports.default = init;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.iniPath = exports.mygamesPath = exports.gameSupported = exports.initGameSupport = exports.gameSupportXboxPass = void 0;\nconst path = __importStar(require(\"path\"));\nconst vortex_api_1 = require(\"vortex-api\");\nexports.gameSupportXboxPass = {\n    skyrimse: {\n        mygamesPath: 'Skyrim Special Edition MS',\n    },\n    fallout4: {\n        mygamesPath: 'Fallout4 MS',\n    },\n};\nconst gameSupport = vortex_api_1.util.makeOverlayableDictionary({\n    skyrim: {\n        mygamesPath: 'skyrim',\n        iniName: 'Skyrim.ini',\n    },\n    enderal: {\n        mygamesPath: 'enderal',\n        iniName: 'Enderal.ini',\n    },\n    skyrimse: {\n        mygamesPath: 'Skyrim Special Edition',\n        iniName: 'Skyrim.ini',\n    },\n    enderalspecialedition: {\n        mygamesPath: 'Enderal Special Edition',\n        iniName: 'Enderal.ini',\n    },\n    skyrimvr: {\n        mygamesPath: 'Skyrim VR',\n        iniName: 'SkyrimVR.ini',\n    },\n    fallout3: {\n        mygamesPath: 'Fallout3',\n        iniName: 'Fallout.ini',\n    },\n    fallout4: {\n        mygamesPath: 'Fallout4',\n        iniName: 'Fallout4.ini',\n    },\n    fallout4vr: {\n        mygamesPath: 'Fallout4VR',\n        iniName: 'Fallout4Custom.ini',\n    },\n    falloutnv: {\n        mygamesPath: 'FalloutNV',\n        iniName: 'Fallout.ini',\n    },\n    starfield: {\n        mygamesPath: 'Starfield',\n        iniName: 'StarfieldCustom.ini',\n    },\n    oblivion: {\n        mygamesPath: 'Oblivion',\n        iniName: 'Oblivion.ini',\n    },\n}, {\n    xbox: exports.gameSupportXboxPass,\n    gog: {\n        skyrimse: {\n            mygamesPath: 'Skyrim Special Edition GOG',\n        },\n    },\n    epic: {\n        skyrimse: {\n            mygamesPath: 'Skyrim Special Edition EPIC',\n        },\n        fallout4: {\n            mygamesPath: 'Fallout4 EPIC',\n        },\n    },\n    enderalseOverlay: {\n        enderalspecialedition: {\n            mygamesPath: 'Skyrim Special Edition',\n            iniName: 'Skyrim.ini',\n        },\n    }\n}, (gameId) => {\n    const discovery = discoveryForGame(gameId);\n    if (((discovery === null || discovery === void 0 ? void 0 : discovery.path) !== undefined)\n        && (gameId === 'enderalspecialedition')\n        && discovery.path.includes('skyrim')) {\n        return 'enderalseOverlay';\n    }\n    else {\n        return discovery === null || discovery === void 0 ? void 0 : discovery.store;\n    }\n});\nlet discoveryForGame = () => undefined;\nfunction initGameSupport(api) {\n    discoveryForGame = (gameId) => vortex_api_1.selectors.discoveryByGame(api.store.getState(), gameId);\n}\nexports.initGameSupport = initGameSupport;\nfunction gameSupported(gameMode) {\n    return gameSupport.has(gameMode);\n}\nexports.gameSupported = gameSupported;\nfunction mygamesPath(gameMode) {\n    return path.join(vortex_api_1.util.getVortexPath('documents'), 'My Games', gameSupport.get(gameMode, 'mygamesPath'));\n}\nexports.mygamesPath = mygamesPath;\nfunction iniPath(gameMode) {\n    return path.join(mygamesPath(gameMode), gameSupport.get(gameMode, 'iniName'));\n}\nexports.iniPath = iniPath;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.oblivionDefaultFonts = void 0;\nconst bluebird_1 = __importDefault(require(\"bluebird\"));\nconst path = __importStar(require(\"path\"));\nconst vortex_api_1 = require(\"vortex-api\");\nexports.oblivionDefaultFonts = {\n    sfontfile_1: 'Data\\\\Fonts\\\\Kingthings_Regular.fnt',\n    sfontfile_2: 'Data\\\\Fonts\\\\Kingthings_Shadowed.fnt',\n    sfontfile_3: 'Data\\\\Fonts\\\\Tahoma_Bold_Small.fnt',\n    sfontfile_4: 'Data\\\\Fonts\\\\Daedric_Font.fnt',\n    sfontfile_5: 'Data\\\\Fonts\\\\Handwritten.fnt',\n};\nconst defaultFontSet = new Set(Object.values(exports.oblivionDefaultFonts).map(font => font.toLowerCase()));\nfunction missingOblivionFont(store, iniFile, gameId) {\n    const discovery = vortex_api_1.selectors.discoveryByGame(store.getState(), gameId);\n    if ((discovery === undefined) || (discovery.path === undefined)) {\n        return bluebird_1.default.resolve([]);\n    }\n    const missingFonts = [];\n    const fonts = [];\n    Object.keys(iniFile.data.Fonts || {})\n        .forEach((key) => {\n        if (!defaultFontSet.has(iniFile.data.Fonts[key].toLowerCase())) {\n            fonts.push(iniFile.data.Fonts[key]);\n        }\n    });\n    return bluebird_1.default.each(fonts, (font) => vortex_api_1.fs.statAsync(path.join(discovery.path, font))\n        .catch(() => { missingFonts.push(font); }))\n        .then(() => bluebird_1.default.resolve(missingFonts));\n}\nexports.default = missingOblivionFont;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst bluebird_1 = __importDefault(require(\"bluebird\"));\nconst path = __importStar(require(\"path\"));\nconst vortex_api_1 = require(\"vortex-api\");\nfunction missingSkyrimFonts(state, skyrimDefaultFonts, gameId) {\n    const gameDiscovery = vortex_api_1.util.getSafe(state, ['settings', 'gameMode', 'discovered', gameId], undefined);\n    const game = vortex_api_1.util.getGame(gameId);\n    const modPath = game.getModPaths(gameDiscovery.path)[''];\n    const fontconfigTxt = path.join(modPath, 'interface', 'fontconfig.txt');\n    return vortex_api_1.fs.readFileAsync(fontconfigTxt)\n        .then((fontconfig) => {\n        const rows = fontconfig.toString().split('\\n');\n        const fonts = rows.filter(row => row.startsWith('fontlib '))\n            .map(row => row.trim().replace(/^fontlib +[\"'](.*)[\"'].*/, '$1').toLowerCase());\n        const removedFonts = fonts\n            .filter((font) => !skyrimDefaultFonts.has(font));\n        return bluebird_1.default.map(removedFonts, (font) => {\n            const fontFile = path.join(modPath, font);\n            return vortex_api_1.fs.statAsync(fontFile)\n                .then(() => null)\n                .catch(() => fontFile);\n        });\n    })\n        .then((missingFonts) => bluebird_1.default.resolve(missingFonts.filter(font => font !== null)))\n        .catch(() => bluebird_1.default.resolve([]));\n}\nexports.default = missingSkyrimFonts;\n","module.exports = require(\"bluebird\");","module.exports = require(\"path\");","module.exports = require(\"vortex-api\");","module.exports = require(\"vortex-parse-ini\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/index.ts\");\n",""],"names":[],"sourceRoot":""}