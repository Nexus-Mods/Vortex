{"version":3,"file":"index.js","mappings":"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","sources":["webpack://theme-switcher/external commonjs2 \"./fontmanager\"","webpack://theme-switcher/./node_modules/font-scanner/index.js","webpack://theme-switcher/./src/SettingsTheme.tsx","webpack://theme-switcher/./src/ThemeEditor.tsx","webpack://theme-switcher/./src/actions.ts","webpack://theme-switcher/./src/index.ts","webpack://theme-switcher/./src/operations.ts","webpack://theme-switcher/./src/reducers.ts","webpack://theme-switcher/./src/util.ts","webpack://theme-switcher/external commonjs2 \"path\"","webpack://theme-switcher/external commonjs2 \"react\"","webpack://theme-switcher/external commonjs2 \"react-bootstrap\"","webpack://theme-switcher/external commonjs2 \"react-i18next\"","webpack://theme-switcher/external commonjs2 \"react-redux\"","webpack://theme-switcher/external commonjs2 \"redux-act\"","webpack://theme-switcher/external commonjs2 \"vortex-api\"","webpack://theme-switcher/webpack/bootstrap","webpack://theme-switcher/webpack/before-startup","webpack://theme-switcher/webpack/startup","webpack://theme-switcher/webpack/after-startup"],"sourcesContent":["module.exports = require(\"./fontmanager\");","let fontManager;\ntry {\n  fontManager = require('./build/Release/fontmanager');\n} catch (releaseNotFoundError) {\n  try {\n    fontManager = require('./build/Debug/fontmanager');\n  } catch (debugNotFoundError) {\n    throw new Error('There is no built binary for font-manager');\n  }\n}\n\nmodule.exports = {\n  findFontSync: (fontDescriptor) => fontManager.findFontSync(fontDescriptor),\n  findFont: (fontDescriptor) => fontManager.findFont(fontDescriptor),\n  findFontsSync: (fontDescriptor) => fontManager.findFontsSync(fontDescriptor),\n  findFonts: (fontDescriptor) => fontManager.findFonts(fontDescriptor),\n  getAvailableFontsSync: () => fontManager.getAvailableFontsSync(),\n  getAvailableFonts: () => fontManager.getAvailableFonts(),\n  substituteFontSync: (postscriptName, text) => fontManager.substituteFontSync(postscriptName, text),\n  substituteFont: (postscriptName, text) => fontManager.substituteFont(postscriptName, text)\n};\n","import { selectTheme } from './actions';\nimport ThemeEditor from './ThemeEditor';\n\nimport * as React from 'react';\nimport { Alert, Button, ControlLabel, FormControl, FormGroup, InputGroup } from 'react-bootstrap';\nimport { withTranslation } from 'react-i18next';\nimport { connect } from 'react-redux';\nimport * as Redux from 'redux';\nimport { ThunkDispatch } from 'redux-thunk';\nimport { actions, ComponentEx, log, tooltip, types, util } from 'vortex-api';\n\nexport interface ISettingsThemeProps {\n  readThemes: () => Promise<string[]>;\n  onCloneTheme: (themeName: string, newName: string) => Promise<void>;\n  onSelectTheme: (themeName: string) => void;\n  onSaveTheme: (themeName: string, variables: { [name: string]: string }) => Promise<void>;\n  onRemoveTheme: (themeName: string) => Promise<void>;\n  readThemeVariables: (themeName: string) => Promise<{ [key: string]: string }>;\n  locationToName: (location: string) => string;\n  nameToLocation: (name: string) => string;\n  isThemeCustom: (themeName: string) => boolean;\n  onEditStyle: (themeName: string) => void;\n  getAvailableFonts: () => Promise<string[]>;\n}\n\ninterface IConnectedProps {\n  currentTheme: string;\n}\n\ninterface IActionProps {\n  onShowDialog: (\n    type: types.DialogType,\n    title: string,\n    content: types.IDialogContent,\n    actions: types.DialogActions,\n  ) => Promise<types.IDialogResult>;\n  onShowError: (title: string, details: any) => void;\n}\n\ntype IWrapperProps = ISettingsThemeProps & IConnectedProps & IActionProps;\ntype IProps = Omit<ISettingsThemeProps, \"readThemes\"> & { themes: string[] } & IConnectedProps & IActionProps;\n\ninterface IComponentState {\n  availableFonts: string[];\n  variables: { [key: string]: string };\n  editable: boolean;\n}\n\nclass SettingsTheme extends ComponentEx<IProps, IComponentState> {\n  constructor(props: IProps) {\n    super(props);\n\n    this.initState({\n      availableFonts: [],\n      variables: {},\n      editable: false,\n    });\n  }\n\n  public UNSAFE_componentWillMount() {\n    this.nextState.availableFonts = Array.from(new Set<string>(\n      [\n        'Inter',\n        'Roboto',\n        'BebasNeue',\n        'Montserrat',\n      ]));\n\n    this.nextState.editable = this.isCustom(this.props.currentTheme);\n    return this.updateVariables(this.props.currentTheme);\n  }\n\n  public UNSAFE_componentWillReceiveProps(newProps: IProps) {\n    if (this.props.currentTheme !== newProps.currentTheme) {\n      this.updateVariables(newProps.currentTheme);\n      this.nextState.editable = this.isCustom(newProps.currentTheme);\n    }\n  }\n\n  public render(): JSX.Element {\n    const { t, currentTheme, themes } = this.props;\n    const { editable, variables } = this.state;\n    return (\n      <div style={{ position: 'relative' }}>\n        <form>\n          <FormGroup controlId='themeSelect'>\n            <ControlLabel>{t('Theme')}</ControlLabel>\n            <InputGroup style={{ width: 300 }}>\n              <FormControl\n                componentClass='select'\n                onChange={this.selectTheme}\n                value={currentTheme}\n              >\n                {themes.map(iter => {\n                  const theme = this.props.locationToName(iter);\n                  return this.renderTheme(theme, theme);\n                })}\n              </FormControl>\n              <InputGroup.Button>\n                <Button bsStyle='primary' onClick={this.onClone} >{t('Clone')}</Button>\n                {editable\n                  ? <Button bsStyle='primary' onClick={this.remove}>{t('Remove')}</Button>\n                  : null}\n              </InputGroup.Button>\n            </InputGroup>\n            {editable ? null : (\n              <Alert bsStyle='info'>\n                {t('Please clone this theme to modify it.')}\n              </Alert>\n            )}\n          </FormGroup>\n        </form>\n        <ThemeEditor\n          t={t}\n          themeName={currentTheme}\n          theme={variables}\n          onApply={this.saveTheme}\n          disabled={!editable}\n          onEditStyle={this.props.onEditStyle}\n          getAvailableFonts={this.props.getAvailableFonts}\n        />\n        {editable\n          ? (\n            <tooltip.IconButton\n              style={{ position: 'absolute', top: 20, right: 20 }}\n              className='btn-embed'\n              icon='refresh'\n              tooltip={t('Reload')}\n              onClick={this.refresh}\n            />\n          ) : null}\n      </div>\n    );\n  }\n\n  public renderTheme(key: string, name: string) {\n    return <option key={key} value={key}>{name}</option>;\n  }\n\n  private refresh = () => {\n    const { currentTheme } = this.props;\n    this.props.onSelectTheme(currentTheme);\n  }\n\n  private saveTheme = (variables: { [name: string]: string }) => {\n    const { currentTheme, onSaveTheme } = this.props;\n    onSaveTheme(currentTheme, variables);\n  }\n\n  private async updateVariables(themeName: string) {\n    this.nextState.variables = await this.props.readThemeVariables(themeName);\n  }\n\n  private onClone = () => {\n    this.cloneTheme(this.props.currentTheme, this.props.themes);\n  }\n\n  private cloneTheme(themeName: string, themes: string[], error?: string) {\n    const { t, onCloneTheme } = this.props;\n\n    // note: In the past we used proper name normalization based on the file system themes are stored on,\n    //   meaning that on a case-sensitive file system (linux), we would have allowed two themes to be named\n    //   \"same\" and \"SAME\".\n    //   I don't feel like that's actually desireable - much less worth making the code more complex over\n    const existing = new Set(themes.map(theme => this.props.locationToName(theme).toUpperCase()));\n\n    return this.props.onShowDialog('question', 'Enter a name', {\n      bbcode: error !== undefined ? `[color=red]${t(error)}[/color]` : undefined,\n      input: [{\n        id: 'name',\n        placeholder: 'Theme Name',\n        value: themeName !== '__default' ? themeName : '',\n      }],\n      condition: (content: types.IDialogContent) => {\n        const res: types.IConditionResult[] = [];\n        const { value } = content.input?.[0] ?? {};\n        if ((value !== undefined) && (existing.has(value.toUpperCase()))) {\n          res.push({\n            id: 'name',\n            errorText: 'Name already used',\n            actions: ['Clone'],\n          });\n        }\n        if ((value !== undefined) && !util.isFilenameValid(value)) {\n          res.push({\n            id: 'name',\n            errorText: 'Invalid symbols in name',\n            actions: ['Clone'],\n          });\n        }\n        return res;\n      },\n    }, [{ label: 'Cancel' }, { label: 'Clone' }])\n      .then(res => {\n        if (res.action === 'Clone') {\n          return onCloneTheme(themeName, res.input.name);\n        }\n        return Promise.resolve();\n      })\n      .catch(err => {\n        if (err instanceof util.ArgumentInvalid) {\n          return this.cloneTheme(themeName, themes, err.message);\n        }\n        this.props.onShowError('Failed to clone theme', err);\n      });\n  }\n\n  private remove = () => {\n    const { t, currentTheme, onShowDialog } = this.props;\n    log('info', 'removing theme', currentTheme);\n    if (!currentTheme || !this.isCustom(currentTheme)) {\n      throw new Error('invalid theme');\n    }\n    onShowDialog('question', t('Confirm removal'), {\n      text: t('Are you sure you want to remove the theme \"{{theme}}\"', {\n        replace: { theme: currentTheme },\n      }),\n    }, [\n      { label: 'Cancel' },\n      {\n        label: 'Confirm',\n        action: () => {\n          this.props.onRemoveTheme(currentTheme);\n        },\n      },\n    ]);\n  }\n\n  private selectTheme = (evt) => {\n    this.context.api.events.emit('analytics-track-click-event', 'Themes', 'Select theme');\n    this.props.onSelectTheme(evt.currentTarget.value);\n  }\n\n  private isCustom = (themeName: string): boolean => {\n    return this.props.isThemeCustom(themeName);\n  }\n}\n\nfunction mapStateToProps(state: any): IConnectedProps {\n  return {\n    currentTheme: state.settings.interface.currentTheme,\n  };\n}\n\nfunction mapDispatchToProps(dispatch: ThunkDispatch<any, any, Redux.Action>): IActionProps {\n  return {\n    onShowError: (title: string, details: any) => util.showError(dispatch, title, details),\n    onShowDialog: (type, title, content, dialogActions) =>\n      dispatch(actions.showDialog(type, title, content, dialogActions)),\n  };\n}\n\nfunction SettingsThemeWrapper(props: IWrapperProps) {\n  const [themes, setThemes] = React.useState<string[]>(undefined);\n\n  React.useEffect(() => {\n    (async () => {\n      const result = await props.readThemes();\n      setThemes(result);\n    })();\n  }, []);\n\n  if (themes !== undefined) {\n    return <SettingsTheme {...props} themes={themes} />\n  }\n\n  return null;\n}\n\nconst SettingsThemeConnected = withTranslation(['common', 'theme-switcher'])(\n  connect(mapStateToProps, mapDispatchToProps)(SettingsThemeWrapper)\n);\n\nexport default SettingsThemeConnected;\n","import { TFunction } from 'i18next';\r\nimport * as React from 'react';\r\nimport { Button, Col, ControlLabel, Form, FormControl, FormGroup,\r\n         Grid, OverlayTrigger, Panel, Popover, Row } from 'react-bootstrap';\r\nimport { ComponentEx, More, Toggle } from 'vortex-api';\r\n\r\ninterface IColor {\r\n  r: number;\r\n  g: number;\r\n  b: number;\r\n  a?: number;\r\n}\r\n\r\ninterface IColorProps {\r\n  name: string;\r\n  color: IColor;\r\n  disabled: boolean;\r\n  onUpdateColor: (name: string, colorHex: string) => void;\r\n}\r\n\r\nfunction toHex(num: number): string {\r\n  let res = num.toString(16);\r\n  if (num < 16) {\r\n    res = '0' + res;\r\n  }\r\n  return res;\r\n}\r\n\r\nfunction colorToHex(color: IColor): string {\r\n  return '#'\r\n    + toHex(color.r)\r\n    + toHex(color.g)\r\n    + toHex(color.b);\r\n}\r\n\r\nfunction colorFromHex(colorHex: string): IColor {\r\n  const parts = colorHex.substr(1).match(/.{2}/g);\r\n  return {\r\n    r: parseInt(parts[0], 16),\r\n    g: parseInt(parts[1], 16),\r\n    b: parseInt(parts[2], 16),\r\n  };\r\n}\r\n\r\nfunction renderColorBox(color: IColor): JSX.Element {\r\n  return (\r\n    <div\r\n      style={{\r\n        width: 16,\r\n        height: 16,\r\n        display: 'inline-block',\r\n        border: 'solid 1px gray',\r\n        marginLeft: 4,\r\n        backgroundColor: colorToHex(color),\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\nclass ColorPreview extends React.Component<IColorProps, never> {\r\n  public render(): JSX.Element {\r\n    const { color, disabled } = this.props;\r\n\r\n    const content = (\r\n      <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n        <input\r\n          type=\"color\"\r\n          value={colorToHex(color)}\r\n          disabled={disabled}\r\n          onChange={this.onUpdate}\r\n          style={{ width: '40px', height: '30px', border: 'none', cursor: disabled ? 'default' : 'pointer' }}\r\n        />\r\n        <span>{colorToHex(color)}</span>\r\n      </div>\r\n    );\r\n\r\n    return content;\r\n  }\r\n\r\n  private onUpdate = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { name, onUpdateColor } = this.props;\r\n    onUpdateColor(name, event.target.value);\r\n  }\r\n}\r\n\r\ninterface IColorEntry {\r\n  name: string;\r\n  value: string;\r\n}\r\n\r\nexport interface IBaseProps {\r\n  t: TFunction;\r\n  themeName: string;\r\n  theme: { [name: string]: string };\r\n  disabled: boolean;\r\n  onApply: (updatedTheme: { [name: string]: string }) => void;\r\n  onEditStyle: (themeName: string) => void;\r\n  getAvailableFonts: () => Promise<string[]>;\r\n}\r\n\r\ntype IProps = IBaseProps;\r\n\r\nconst colorDefaults: IColorEntry[] = [\r\n  { name: 'brand-primary', value: '#D78F46' },\r\n  { name: 'brand-highlight', value: '#00C1FF' },\r\n  { name: 'brand-success', value: '#86B951' },\r\n  { name: 'brand-info', value: '#00C1FF' },\r\n  { name: 'brand-warning', value: '#FF7300' },\r\n  { name: 'brand-danger', value: '#FF1C38' },\r\n  { name: 'brand-bg', value: '#2A2C2B' },\r\n  { name: 'brand-menu', value: '#4C4C4C' },\r\n  { name: 'brand-secondary', value: '#D78F46' },\r\n  { name: 'brand-clickable', value: '#D78F46' },\r\n  { name: 'text-color', value: '#eeeeee' },\r\n  { name: 'text-color-disabled', value: '#bbbbbb' },\r\n  { name: 'link-color', value: '#D78F46' },\r\n];\r\n\r\ninterface IComponentState {\r\n  fontFamily: string;\r\n  fontFamilyHeadings: string;\r\n  fontSize: number;\r\n  hidpiScale: number;\r\n  colors: { [key: string]: string };\r\n  margin: number;\r\n  dashletHeight: number;\r\n  titlebarRows: number;\r\n  dark: boolean;\r\n\r\n  availableFonts: string[];\r\n}\r\n\r\nconst defaultTheme = {\r\n  colors: {},\r\n  fontSize: 12,\r\n  fontFamily: 'Inter',\r\n  fontFamilyHeadings: 'Inter',\r\n  hidpiScale: 100,\r\n  margin: 30,\r\n  dashletHeight: 120,\r\n  titlebarRows: 2,\r\n  dark: true,\r\n};\r\n\r\nconst standardFonts: string[] = [\r\n  'Inter',\r\n  'Roboto',\r\n  'Montserrat',\r\n  'BebasNeue',\r\n  'sans-serif',\r\n  'serif',\r\n  'Arial',\r\n  'Courier New',\r\n  'Georgia',\r\n  'Impact',\r\n  'Marlett',\r\n  'Monaco',\r\n  'Tahoma',\r\n  'Times New Roman',\r\n  'Verdana',\r\n];\r\n\r\nclass ThemeEditor extends ComponentEx<IProps, IComponentState> {\r\n  private static BUCKETS = 3;\r\n\r\n  constructor(props: IProps) {\r\n    super(props);\r\n\r\n    this.initState({\r\n      ...defaultTheme,\r\n      availableFonts: standardFonts,\r\n    });\r\n  }\r\n\r\n  public componentDidMount() {\r\n    this.setColors(this.props.theme);\r\n    this.setFontSize(this.props.theme);\r\n    this.setHiDPIScale(this.props.theme);\r\n    this.setFontFamily(this.props.theme);\r\n    this.setFontFamilyHeadings(this.props.theme);\r\n    this.setMargin(this.props.theme);\r\n    this.setDashletHeight(this.props.theme);\r\n    this.setDark(this.props.theme);\r\n    this.setTitlebarRows(this.props.theme);\r\n  }\r\n\r\n  public UNSAFE_componentWillReceiveProps(newProps: IProps) {\r\n    if (newProps.theme !== this.props.theme) {\r\n      this.setColors(newProps.theme);\r\n      this.setFontSize(newProps.theme);\r\n      this.setHiDPIScale(newProps.theme);\r\n      this.setFontFamily(newProps.theme);\r\n      this.setFontFamilyHeadings(newProps.theme);\r\n      this.setMargin(newProps.theme);\r\n      this.setDashletHeight(newProps.theme);\r\n      this.setDark(newProps.theme);\r\n      this.setTitlebarRows(this.props.theme);\r\n    }\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { t, disabled } = this.props;\r\n    const { colors, dark, dashletHeight, fontFamily, fontFamilyHeadings,\r\n      fontSize, margin, titlebarRows } = this.state;\r\n\r\n    const availableFonts = this.state.availableFonts.slice(0);\r\n    if (!availableFonts.includes(fontFamily)) {\r\n      availableFonts.push(fontFamily);\r\n    }\r\n\r\n    const buckets: IColorEntry[][] = colorDefaults.reduce((prev, value, idx) => {\r\n      if (idx < ThemeEditor.BUCKETS) {\r\n        prev[idx % ThemeEditor.BUCKETS] = [];\r\n      }\r\n      prev[idx % ThemeEditor.BUCKETS].push(value);\r\n      return prev;\r\n    }, new Array(ThemeEditor.BUCKETS));\r\n    return (\r\n      <div>\r\n        <Form disabled={disabled} horizontal>\r\n          <FormGroup>\r\n            <Col sm={4}>\r\n              <ControlLabel>{t('Font Size:')} {fontSize}</ControlLabel>\r\n            </Col>\r\n            <Col sm={8}>\r\n              <FormControl\r\n                type='range'\r\n                value={fontSize}\r\n                min={8}\r\n                max={24}\r\n                onChange={this.onChangeFontSize}\r\n                disabled={disabled}\r\n              />\r\n            </Col>\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <Col sm={4}>\r\n              <ControlLabel>{t('Margins:')}</ControlLabel>\r\n            </Col>\r\n            <Col sm={8}>\r\n              <FormControl\r\n                type='range'\r\n                value={margin}\r\n                min={0}\r\n                max={80}\r\n                onChange={this.onChangeMargin}\r\n                disabled={disabled}\r\n              />\r\n            </Col>\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <Col sm={4}>\r\n              <ControlLabel>{t('Font Family:')}</ControlLabel>\r\n            </Col>\r\n            <Col sm={4}>\r\n              <FormControl\r\n                componentClass='select'\r\n                onChange={this.onChangeFontFamily}\r\n                value={fontFamily}\r\n                disabled={disabled}\r\n              >\r\n                {availableFonts.map(this.renderFontOption)}\r\n              </FormControl>\r\n            </Col>\r\n            <Col sm={4}>\r\n              <Button onClick={this.readFont}>{t('Read system fonts')}</Button>\r\n              <More id='more-system-fonts' name={t('System Fonts')}>\r\n                {t('Makes all system fonts installed on the system available in the Font dropdowns. '\r\n                   + 'This function seems to cause Vortex to crash for a very small number '\r\n                   + 'of users and we have not been able to identify what sets the '\r\n                   + 'affected systems apart yet.')}\r\n              </More>\r\n            </Col>\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <Col smOffset={4} sm={8}>\r\n              <FormControl.Static style={{ fontFamily, fontSize: fontSize.toString() + 'px' }}>\r\n                {t('The quick brown fox jumps over the lazy dog')}\r\n              </FormControl.Static>\r\n            </Col>\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <Col sm={4}>\r\n              <ControlLabel>{t('Font Family (Headings):')}</ControlLabel>\r\n            </Col>\r\n            <Col sm={8}>\r\n              <FormControl\r\n                componentClass='select'\r\n                onChange={this.onChangeFontFamilyHeadings}\r\n                value={fontFamilyHeadings}\r\n                disabled={disabled}\r\n              >\r\n                {availableFonts.map(this.renderFontOption)}\r\n              </FormControl>\r\n            </Col>\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <Col smOffset={4} sm={8}>\r\n              <FormControl.Static\r\n                style={{\r\n                  fontFamily: fontFamilyHeadings,\r\n                  fontSize: fontSize.toString() + 'px',\r\n                  textTransform: 'uppercase',\r\n                } as any}\r\n              >\r\n                {t('The quick brown fox jumps over the lazy dog')}\r\n              </FormControl.Static>\r\n            </Col>\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <Col sm={4}>\r\n              <ControlLabel>\r\n                {t('Dashlet Height:')} {dashletHeight}px\r\n                <More id='more-dashlet-height' name={t('Dashlet Height')}>\r\n                  {t('Every dashlet (the widgets on the Dashboards) has a height that is a '\r\n                    + 'multiple of this value and a width of either 1/3, 2/3 or 3/3 of the '\r\n                    + 'window width. Here you can adjust the base height of dashlets but '\r\n                    + 'we can\\'t promise every dashlet will look good or even be usable with '\r\n                    + 'non-default height.')}\r\n                </More>\r\n              </ControlLabel>\r\n            </Col>\r\n            <Col sm={8}>\r\n              <FormControl\r\n                type='range'\r\n                value={dashletHeight}\r\n                min={50}\r\n                max={1000}\r\n                step={4}\r\n                onChange={this.onChangeDashletHeight}\r\n                disabled={disabled}\r\n              />\r\n            </Col>\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <Col sm={4}>\r\n              <ControlLabel>\r\n                {t('Titlebar Rows:')} {titlebarRows}\r\n              </ControlLabel>\r\n            </Col>\r\n            <Col sm={8}>\r\n              <FormControl\r\n                type='range'\r\n                value={titlebarRows}\r\n                min={1}\r\n                max={3}\r\n                step={1}\r\n                onChange={this.onChangeTitlebarRows}\r\n                disabled={disabled}\r\n              />\r\n            </Col>\r\n          </FormGroup>\r\n        </Form>\r\n\r\n        <Panel>\r\n          <div className='panel-body'>\r\n            <Grid style={{ width: '100%' }}>\r\n              {buckets[0].map((value, idx) => {\r\n                return (\r\n                  <Row key={idx}>\r\n                    {buckets.map(bucket =>\r\n                      bucket[idx] !== undefined\r\n                        ? this.renderEntry(bucket[idx], colors[bucket[idx].name])\r\n                        : null)}\r\n                  </Row>\r\n                );\r\n              })}\r\n            </Grid>\r\n          </div>\r\n        </Panel>\r\n        <Toggle checked={dark} onToggle={this.onChangeDark} disabled={disabled}>\r\n          {t('Dark Theme')}\r\n          <More id='more-dark-theme' name={t('Dark Theme')}>\r\n            {t('When this is enabled, grays are essentially inverted, so a light gray becomes '\r\n              + 'a dark gray and vice versa.\\n'\r\n              + 'If your theme is mostly light foreground colors on dark background, this '\r\n              + 'will produce better contrast.')}\r\n          </More>\r\n        </Toggle>\r\n        {disabled ? null : <a onClick={this.editManually}>{t('Edit CSS manually...')}</a>}\r\n        {disabled ? null : (\r\n          <div className='pull-right'>\r\n            <Button bsStyle='primary' onClick={this.revert}>{t('Revert')}</Button>\r\n            <Button bsStyle='primary' onClick={this.apply}>{t('Apply')}</Button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private readFont = () => {\r\n    this.props.getAvailableFonts().then(fonts =>\r\n      this.nextState.availableFonts = fonts);\r\n  }\r\n\r\n  private renderEntry = (entry: IColorEntry, value: string) => {\r\n    const { disabled } = this.props;\r\n    return (\r\n      <Col key={entry.name} sm={4} md={4} lg={4} style={{ display: 'inline-flex' }}>\r\n        <span style={{ marginRight: 'auto' }}>{entry.name}</span>\r\n        <ColorPreview\r\n          name={entry.name}\r\n          color={colorFromHex(value || entry.value)}\r\n          onUpdateColor={this.updateColor}\r\n          disabled={disabled}\r\n        />\r\n      </Col>\r\n    );\r\n  }\r\n\r\n  private renderFontOption(name: string) {\r\n    return (\r\n      <option key={name}>\r\n        {name}\r\n      </option>\r\n    );\r\n  }\r\n\r\n  private editManually = () => {\r\n    const { disabled, themeName } = this.props;\r\n    if (disabled) {\r\n      return;\r\n    }\r\n\r\n    this.props.onEditStyle(themeName);\r\n  }\r\n\r\n  private revert = () => {\r\n    this.setColors(this.props.theme);\r\n    this.setFontSize(this.props.theme);\r\n    this.setHiDPIScale(this.props.theme);\r\n    this.setFontFamily(this.props.theme);\r\n    this.setFontFamilyHeadings(this.props.theme);\r\n    this.setMargin(this.props.theme);\r\n    this.setDark(this.props.theme);\r\n    this.setTitlebarRows(this.props.theme);\r\n  }\r\n\r\n  private apply = () => {\r\n    let fontFamily = this.state.fontFamily;\r\n    if (!['serif', 'sans-serif'].includes(fontFamily)) {\r\n      fontFamily = `\"${fontFamily}\"`;\r\n    }\r\n    const theme: { [key: string]: string } = {\r\n      ...this.state.colors,\r\n      'font-size-base': this.state.fontSize.toString() + 'px',\r\n      'hidpi-scale-factor': this.state.hidpiScale.toString() + '%',\r\n      'font-family-base': fontFamily,\r\n      'font-family-headings': '\"' + this.state.fontFamilyHeadings + '\"',\r\n      'gutter-width': this.state.margin.toString() + 'px',\r\n      'dashlet-height': `${this.state.dashletHeight}px`,\r\n      'dark-theme': this.state.dark ? 'true' : 'false',\r\n      'titlebar-rows': this.state.titlebarRows.toString(),\r\n    };\r\n    const grayNames = ['gray-lighter', 'gray-light', 'gray', 'gray-dark', 'gray-darker'];\r\n    let grayColors = ['DEE2E6', 'DDDDDD', 'A9A9A9', '4C4C4C', '2A2C2B'];\r\n    if (this.state.dark) {\r\n      grayColors = grayColors.reverse();\r\n    }\r\n\r\n    grayNames.forEach((id: string, idx: number) => { theme[id] = '#' + grayColors[idx]; });\r\n\r\n    this.props.onApply(theme);\r\n  }\r\n\r\n  private updateColor = (name: string, color: string) => {\r\n    this.nextState.colors[name] = color;\r\n  }\r\n\r\n  private onChangeFontSize = (evt) => {\r\n    this.nextState.fontSize = evt.currentTarget.value;\r\n  }\r\n\r\n  private onChangeHiDPIScale = (evt) => {\r\n    this.nextState.hidpiScale = evt.currentTarget.value;\r\n  }\r\n\r\n  private onChangeFontFamily = (evt) => {\r\n    this.nextState.fontFamily = evt.currentTarget.value;\r\n  }\r\n\r\n  private onChangeFontFamilyHeadings = (evt) => {\r\n    this.nextState.fontFamilyHeadings = evt.currentTarget.value;\r\n  }\r\n\r\n  private onChangeMargin = evt => {\r\n    this.nextState.margin = evt.currentTarget.value;\r\n  }\r\n\r\n  private onChangeDashletHeight = evt => {\r\n    this.nextState.dashletHeight = evt.currentTarget.value;\r\n  }\r\n\r\n  private onChangeTitlebarRows = evt => {\r\n    this.nextState.titlebarRows = evt.currentTarget.value;\r\n  }\r\n\r\n  private onChangeDark = newValue => {\r\n    this.nextState.dark = newValue;\r\n  }\r\n\r\n  private setFontSize(theme: { [name: string]: string }) {\r\n    this.nextState.fontSize = (theme['font-size-base'] !== undefined)\r\n      ? parseInt(theme['font-size-base'], 10)\r\n      : defaultTheme.fontSize;\r\n  }\r\n\r\n  private setHiDPIScale(theme: { [name: string]: string }) {\r\n    this.nextState.hidpiScale = (theme['hidpi-scale-factor'] !== undefined)\r\n      ? parseInt(theme['hidpi-scale-factor'], 10)\r\n      : defaultTheme.hidpiScale;\r\n  }\r\n\r\n  private setFontFamily(theme: { [name: string]: string }) {\r\n    const fontFamily = theme['font-family-base'] || defaultTheme.fontFamily;\r\n    this.nextState.fontFamily = fontFamily.replace(/^\"|\"$/g, '');\r\n  }\r\n\r\n  private setFontFamilyHeadings(theme: { [name: string]: string }) {\r\n    const fontFamily = theme['font-family-headings'] || defaultTheme.fontFamilyHeadings;\r\n    this.nextState.fontFamilyHeadings = fontFamily.replace(/^\"|\"$/g, '');\r\n  }\r\n\r\n  private setMargin(theme: { [name: string]: string }) {\r\n    this.nextState.margin = theme['gutter-width'] !== undefined\r\n      ? parseInt(theme['gutter-width'], 10)\r\n      : defaultTheme.margin;\r\n  }\r\n\r\n  private setDashletHeight(theme: { [name: string]: string }) {\r\n    if (theme['dashlet-height'] !== undefined) {\r\n      this.nextState.dashletHeight = parseInt(theme['dashlet-height'], 10);\r\n    }\r\n  }\r\n\r\n  private setDark(theme: { [name: string]: string }) {\r\n    const dark = theme['dark-theme'] !== undefined\r\n      ? theme['dark-theme'] === 'true'\r\n      : defaultTheme.dark;\r\n    this.nextState.dark = dark;\r\n  }\r\n\r\n  private setTitlebarRows(theme: { [name: string]: string }) {\r\n    if (theme['titlebar-rows'] !== undefined) {\r\n      this.nextState.titlebarRows = parseInt(theme['titlebar-rows'], 10);\r\n    }\r\n  }\r\n\r\n  private setColors(theme: { [name: string]: string }) {\r\n    this.nextState.colors = {};\r\n    colorDefaults.forEach(entry => {\r\n      if (colorDefaults.find(color => color.name === entry.name) !== undefined) {\r\n        this.nextState.colors[entry.name] = theme[entry.name] || entry.value;\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nexport default ThemeEditor;\r\n","import { createAction } from 'redux-act';\r\n\r\nexport const selectTheme = createAction<string, {}>('SELECT_UI_THEME');\r\n","import * as ops from './operations';\r\nimport settingsReducer from './reducers';\r\nimport SettingsTheme from './SettingsTheme';\r\nimport { getAvailableFonts, themesPath } from './util';\r\n\r\nimport * as path from 'path';\r\nimport { fs, log, types, util } from 'vortex-api';\r\n\r\nfunction applyTheme(api: types.IExtensionApi, theme: string, initial: boolean) {\r\n  log('debug', 'applyTheme() called', {\r\n    theme,\r\n    initial,\r\n    timestamp: new Date().toISOString()\r\n  });\r\n  \r\n  if (!initial) {\r\n    log('debug', 'Clearing existing stylesheets');\r\n    api.clearStylesheet();\r\n  }\r\n\r\n  if (theme === null) {\r\n    log('debug', 'Applying null theme - clearing all stylesheets');\r\n    api.setStylesheet('variables', undefined);\r\n    api.setStylesheet('fonts', undefined);\r\n    api.setStylesheet('style', undefined);\r\n    return;\r\n  }\r\n\r\n  return util.readExtensibleDir('theme', path.join(__dirname, 'themes'), themesPath())\r\n    .then(themes => {\r\n      log('debug', 'Available themes found', {\r\n        themesCount: themes.length,\r\n        themesList: themes.map(t => path.basename(t)),\r\n        requestedTheme: theme\r\n      });\r\n      \r\n      const selected = themes.find(iter => path.basename(iter) === theme);\r\n      if (selected === undefined) {\r\n        log('warn', 'Requested theme not found', {\r\n          requestedTheme: theme,\r\n          availableThemes: themes.map(t => path.basename(t))\r\n        });\r\n        return Promise.resolve();\r\n      }\r\n      \r\n      log('debug', 'Selected theme path', {\r\n        theme,\r\n        selectedPath: selected\r\n      });\r\n\r\n      return fs.statAsync(path.join(selected, 'variables.scss'))\r\n        .then(() => {\r\n          log('debug', 'Loading variables.scss', { path: path.join(selected, 'variables') });\r\n          api.setStylesheet('variables', path.join(selected, 'variables'));\r\n        })\r\n        .catch(() => {\r\n          log('debug', 'variables.scss not found, skipping');\r\n          api.setStylesheet('variables', undefined);\r\n        })\r\n        .then(() => fs.statAsync(path.join(selected, 'details.scss')))\r\n        .then(() => {\r\n          log('debug', 'Loading details.scss', { path: path.join(selected, 'details') });\r\n          api.setStylesheet('details', path.join(selected, 'details'));\r\n        })\r\n        .catch(() => {\r\n          log('debug', 'details.scss not found, skipping');\r\n          api.setStylesheet('details', undefined);\r\n        })\r\n        .then(() => fs.statAsync(path.join(selected, 'fonts.scss')))\r\n        .then(() => {\r\n          log('debug', 'Loading fonts.scss', { path: path.join(selected, 'fonts') });\r\n          api.setStylesheet('fonts', path.join(selected, 'fonts'));\r\n        })\r\n        .catch(() => {\r\n          log('debug', 'fonts.scss not found, skipping');\r\n          api.setStylesheet('fonts', undefined);\r\n        })\r\n        .then(() => fs.statAsync(path.join(selected, 'style.scss')))\r\n        .then(() => {\r\n          log('debug', 'Loading style.scss', { path: path.join(selected, 'style') });\r\n          api.setStylesheet('style', path.join(selected, 'style'));\r\n          \r\n          // Add verification that CSS injection will happen\r\n          log('debug', 'Theme stylesheets set, waiting for CSS injection verification');\r\n          \r\n          // Check DOM injection after a short delay to allow for async processing\r\n          setTimeout(() => {\r\n            const themeElement = document.getElementById('theme');\r\n            const headElement = document.getElementsByTagName('head')[0];\r\n            \r\n            log('debug', 'CSS injection verification check', {\r\n              themeElementExists: !!themeElement,\r\n              themeElementContent: themeElement?.innerHTML?.substring(0, 200) || 'none',\r\n              themeElementContentLength: themeElement?.innerHTML?.length || 0,\r\n              totalHeadChildren: headElement?.children?.length || 0,\r\n              headChildrenWithThemeId: Array.from(headElement?.children || []).filter(el => el.id === 'theme').length,\r\n              timestamp: new Date().toISOString()\r\n            });\r\n            \r\n            if (!themeElement || !themeElement.innerHTML) {\r\n              log('warn', 'CSS injection verification FAILED - theme element missing or empty', {\r\n                theme,\r\n                selectedPath: selected,\r\n                themeElementExists: !!themeElement,\r\n                themeElementContent: themeElement?.innerHTML || 'none'\r\n              });\r\n            } else {\r\n              log('info', 'CSS injection verification SUCCESS - theme element found with content', {\r\n                theme,\r\n                selectedPath: selected,\r\n                contentLength: themeElement.innerHTML.length,\r\n                contentPreview: themeElement.innerHTML.substring(0, 100)\r\n              });\r\n            }\r\n          }, 500); // Wait 500ms for CSS compilation and injection\r\n        })\r\n        .catch(() => {\r\n          log('debug', 'style.scss not found, skipping');\r\n          api.setStylesheet('style', undefined);\r\n        })\r\n        .then(() => {\r\n          log('info', 'Theme applied successfully', { theme, selectedPath: selected });\r\n        });\r\n    });\r\n}\r\n\r\nfunction editStyle(api: types.IExtensionApi, themeName: string): Promise<void> {\r\n  const stylePath = path.join(ops.themePath(themeName), 'style.scss');\r\n  return fs.ensureFileAsync(stylePath)\r\n    .then(() =>\r\n      util.opn(stylePath)\r\n        .catch(util.MissingInterpreter, (err) => {\r\n          api.showDialog('error', 'No handler found', {\r\n            text: 'You don\\'t have an editor associated with scss files. '\r\n              + 'You can fix this by opening the following file from your file explorer, '\r\n              + 'pick your favorite text editor and when prompted, choose to always open '\r\n              + 'that file type with that editor.',\r\n            message: err.url,\r\n          }, [\r\n            { label: 'Close' },\r\n          ]);\r\n        })\r\n        .catch(err => {\r\n          log('error', 'failed to open', err);\r\n        }));\r\n}\r\n\r\nfunction init(context: types.IExtensionContext) {\r\n  context.registerReducer(['settings', 'interface'], settingsReducer);\r\n\r\n  const onCloneTheme = (themeName: string, newName: string) =>\r\n    ops.cloneTheme(context.api, themeName, newName);\r\n  const onSelectTheme = (theme: string) => ops.selectTheme(context.api, theme);\r\n  const saveTheme = (themeName: string, variables: { [name: string]: string }) =>\r\n    ops.saveTheme(context.api, themeName, variables);\r\n  const removeTheme = (themeName: string) => ops.removeTheme(context.api, themeName);\r\n  const onEditStyle = (themeName: string) => editStyle(context.api, themeName);\r\n\r\n  context.registerSettings('Theme', SettingsTheme, () => ({\r\n    readThemes: ops.readThemes,\r\n    onCloneTheme,\r\n    onSelectTheme,\r\n    readThemeVariables: ops.readThemeVariables,\r\n    onSaveTheme: saveTheme,\r\n    onRemoveTheme: removeTheme,\r\n    locationToName: ops.themeName,\r\n    nameToLocation: ops.themePath,\r\n    isThemeCustom: ops.isThemeCustom,\r\n    onEditStyle,\r\n    getAvailableFonts,\r\n  }));\r\n\r\n  context.once(() => {\r\n    const store = context.api.store;\r\n    const currentState = store.getState();\r\n    const currentTheme = currentState.settings.interface.currentTheme;\r\n    \r\n    log('debug', 'Theme-switcher extension initializing', {\r\n      currentTheme,\r\n      settingsInterface: currentState.settings.interface,\r\n      hasStore: !!store,\r\n      hasEvents: !!context.api.events\r\n    });\r\n\r\n    context.api.events.on('select-theme', (selectedThemePath: string) => {\r\n      log('debug', 'select-theme event received', {\r\n        selectedThemePath,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n      applyTheme(context.api, selectedThemePath, false);\r\n    });\r\n    \r\n    context.api.events.on('apply-theme', (themeName: string) => {\r\n      log('debug', 'apply-theme event received', {\r\n        themeName,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n      applyTheme(context.api, themeName, false);\r\n    });\r\n\r\n    log('debug', 'Applying initial theme on startup', {\r\n      initialTheme: currentTheme\r\n    });\r\n    \r\n    return applyTheme(context.api, currentTheme, true);\r\n  });\r\n\r\n  return true;\r\n}\r\n\r\nexport default init;\r\n","import * as path from 'path';\nimport { fs, log, types, util } from 'vortex-api';\n\nimport * as actions from './actions';\nimport { themesPath } from './util';\n\nlet themes: string[] = [];\n\nexport function readThemes() {\n  const bundledPath = path.join(__dirname, 'themes');\n  return util.readExtensibleDir('theme', bundledPath, themesPath())\n    .tap(extThemes => {\n      themes = extThemes;\n    });\n}\n\nexport function themeName(location: string): string {\n  return path.basename(location);\n}\n\nexport function themePath(themeName: string): string | undefined {\n  themeName = themeName.replace(/^__/, '');\n  return themes.find(theme => path.basename(theme) === themeName);\n}\n\nfunction saveThemeInternal(outputPath: string, variables: { [name: string]: string }) {\n  const theme = Object.keys(variables)\n    .map(name => `\\$${name}: ${variables[name]};`);\n  return fs.writeFileAsync(\n    path.join(outputPath, 'variables.scss'),\n    '// Automatically generated. Changes to this file will be overwritten.\\r\\n'\n    + theme.join('\\r\\n'));\n}\n\nexport function saveTheme(api: types.IExtensionApi, themeName: string,\n                          variables: { [name: string]: string }) {\n  const t = api.translate;\n\n  saveThemeInternal(path.join(themesPath(), themeName), variables)\n    .then(() => {\n      api.events.emit('select-theme', themeName);\n    })\n    .catch(err => {\n      api.showErrorNotification(\n        t('Unable to save theme'), err,\n        // Theme directory should have been present at this point but was removed\n        //  by an external factor. This could be due to:\n        // (Anti Virus, manually removed by mistake, etc); this is not Vortex's fault.\n        { allowReport: (err as any).code !== 'ENOENT' });\n    });\n}\n\nexport function selectTheme(api: types.IExtensionApi, theme: string) {\n  api.store.dispatch(actions.selectTheme(theme));\n  api.events.emit('select-theme', theme);\n}\n\nexport function cloneTheme(api: types.IExtensionApi, themeName: string,\n                           newName: string): Promise<void> {\n  const t = api.translate;\n\n  if (newName && (themes.findIndex(iter => path.basename(iter) === newName) === -1)) {\n    const targetPath = path.join(themesPath(), newName);\n    const sourcePath = themePath(themeName);\n    if (sourcePath === undefined) {\n      return Promise.reject(new Error('no path for current theme'));\n    }\n    api.events.emit('analytics-track-click-event', 'Themes', 'Clone theme');\n\n    return fs.ensureDirAsync(targetPath)\n      .then(() => readThemeVariables(themeName))\n      .then(variables =>\n        saveThemeInternal(path.join(themesPath(), newName), variables))\n      .then(() => (sourcePath !== undefined)\n        ? fs.readdirAsync(sourcePath)\n        : Promise.resolve([]))\n      .map(files => fs.copyAsync(path.join(sourcePath, files), path.join(targetPath, files)))\n      .then(() => {\n        themes.push(targetPath);\n        selectTheme(api, newName);\n      })\n      .catch(err => api.showErrorNotification(\n        t('Failed to read theme directory'),\n        err,\n        // Theme directory has been removed by an external method -\n        // (Anti Virus, manually removed by mistake, etc); this is not Vortex's fault.\n        { allowReport: (err as any).code !== 'ENOENT' }));\n  } else {\n    return Promise.reject(new util.ArgumentInvalid('Name already used'));\n    // cloneTheme(api, themeName, themes, t('Name already used.'));\n  }\n}\n\nexport function readThemeVariables(themeName: string): Promise<{ [key: string]: string }> {\n  const currentThemePath = themePath(themeName);\n  if (currentThemePath === undefined) {\n    // likely was deleted outside Vortex\n    log('warn', 'theme not found', themeName);\n    return Promise.resolve({});\n  }\n \n  return fs.readFileAsync(path.join(currentThemePath, 'variables.scss'))\n    .then(data => {\n      const variables = {};\n      data.toString('utf-8').split('\\r\\n').forEach(line => {\n        const [key, value] = line.split(':');\n        if (value !== undefined) {\n          variables[key.substr(1)] = value.trim().replace(/;*$/, '');\n        }\n      });\n      return variables;\n    })\n    // an exception indicates no variables set. that's fine, defaults are used\n    .catch(() => {\n      return {};\n    });\n}\n\nexport function removeTheme(api: types.IExtensionApi, themeName: string) {\n  selectTheme(api, 'default');\n  const currentThemePath = themePath(themeName);\n  this.nextState.themes = themes\n    .filter(iter => iter !== currentThemePath);\n  return fs.removeAsync(currentThemePath)\n    .then(() => {\n      log('info', 'removed theme', themeName);\n    })\n    .catch(err => {\n      log('error', 'failed to remove theme', { err });\n    });\n}\n\nexport function isThemeCustom(themeName: string): boolean {\n  const themeFilePath = themePath(themeName);\n  if (themeFilePath === undefined) {\n    // We don't have the filepath to this theme..\n    //  possibly a race condition ? if so, this should\n    //  clear up next time the state updates.\n    //  https://github.com/Nexus-Mods/Vortex/issues/7191\n    //\n    // the above issue was in the remove callback so the likely scenario is\n    // that that event was triggered twice and on the second time it was handled\n    // the theme is already gone.\n    return false;\n  }\n\n  // isChildPath plays a bit fast and loose when it comes to directory normalization\n  // if we don't pass in a normalizer, but that shouldn't be a problem here, the official\n  // themes are in the application folder and the themes are in APPDATA or ProgramData so\n  // upper/lower case shouldn't be that big of a deal\n  return util.isChildPath(themeFilePath, themesPath());\n}\n","import { types, util, log } from 'vortex-api';\n\nimport * as actions from './actions';\n\n// Set default theme based on platform\nconst getDefaultTheme = () => {\n  // Use macOS Tahoe theme as default on Mac systems\n  if (process.platform === 'darwin') {\n    return 'macos-tahoe';\n  }\n  // Use default theme on other platforms\n  return '__default';\n};\n\nconst settingsReducer: types.IReducerSpec = {\n  reducers: {\n    [actions.selectTheme as any]: (state, payload) => {\n      log('debug', 'Theme reducer: selectTheme action dispatched', {\n        previousTheme: state.currentTheme,\n        newTheme: payload,\n        timestamp: new Date().toISOString()\n      });\n      \n      const newState = util.setSafe(state, ['currentTheme'], payload);\n      \n      log('debug', 'Theme reducer: state updated', {\n        oldState: state,\n        newState,\n        currentTheme: newState.currentTheme\n      });\n      \n      return newState;\n    },\n  },\n  defaults: {\n    currentTheme: getDefaultTheme(),\n  },\n};\n\nlog('debug', 'Theme reducer initialized with defaults', {\n  platform: process.platform,\n  defaultTheme: process.platform === 'darwin' ? 'macos-tahoe' : '__default'\n});\n\nexport default settingsReducer;\n","import * as path from 'path';\r\nimport { log, util } from 'vortex-api';\r\n\r\nexport function themesPath(): string {\r\n  return path.join(util.getVortexPath('userData'), 'themes');\r\n}\r\n\r\ninterface IFont {\r\n  family: string;\r\n}\r\n\r\nconst DEFAULT_FONTS = [\r\n  'Inter',\r\n  'Roboto',\r\n  'Montserrat',\r\n  'BebasNeue',\r\n  'Arial',\r\n  'Helvetica',\r\n  'Times New Roman',\r\n  'Courier New',\r\n  'Verdana',\r\n  'Georgia'\r\n];\r\n\r\nconst getAvailableFontImpl = () => {\r\n  try {\r\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\r\n    const fontScanner = require('font-scanner');\r\n    return fontScanner.getAvailableFonts()\r\n      .then((fonts: IFont[]) => Array.from(new Set<string>([\r\n        ...DEFAULT_FONTS,\r\n        ...(fonts || []).map(font => font.family).sort(),\r\n      ])));\r\n  } catch (err) {\r\n    log('warn', 'font-scanner not available, using default fonts', err);\r\n    return Promise.resolve(DEFAULT_FONTS);\r\n  }\r\n};\r\n\r\nconst getAvailableFonts: () => Promise<string[]> =\r\n  util.makeRemoteCall('get-available-fonts', getAvailableFontImpl);\r\n\r\nexport { getAvailableFonts };\r\n","module.exports = require(\"path\");","module.exports = require(\"react\");","module.exports = require(\"react-bootstrap\");","module.exports = require(\"react-i18next\");","module.exports = require(\"react-redux\");","module.exports = require(\"redux-act\");","module.exports = require(\"vortex-api\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/index.ts\");\n",""],"names":[],"sourceRoot":""}